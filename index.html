<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silence Proxy</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/utils/variables.css">
    <link rel="stylesheet" href="css/utils/animations.css">
    <link rel="stylesheet" href="css/components/headers.css">
    <link rel="stylesheet" href="css/components/cards.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/modals.css">
    <link rel="stylesheet" href="css/components/pages.css">
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Font Awesome –±–µ–∑ —Ç—Ä–µ–∫–∏–Ω–≥–∞ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
</head>
<body>
    <div id="app">
        <!-- Fallback content -->
        <div id="fallback-message" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #0F0F12; color: #FDECEF; display: flex; align-items: center; justify-content: center; z-index: 10000; padding: 2rem; text-align: center;">
            <div>
                <h1 style="margin-bottom: 1rem; background: linear-gradient(135deg, #FDECEF, #745C97); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Silence Proxy</h1>
                <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</p>
            </div>
        </div>
        
        <header class="header" id="header"></header>
        <main class="main" id="main"></main>
        <div id="modals-container"></div>
        <div id="pages-container"></div>
    </div>

    <!-- JS –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ -->
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/database.js"></script>
    <script src="js/components/paymentProcessor.js"></script>
    <script src="js/components/vpnManager.js"></script> <!-- VPN Manager –ø–µ—Ä–µ–¥ Subscription Manager -->
    <script src="js/components/subscriptionManager.js"></script>
    <script src="js/components/modalManager.js"></script>
    <script src="js/components/pageManager.js"></script>
    <script src="js/components/deviceManager.js"></script>
    <script src="js/app.js"></script>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            if (e.error && e.error.message && e.error.message.includes('PaymentProcessor')) {
                const fallback = document.getElementById('fallback-message');
                if (fallback) {
                    fallback.innerHTML = `
                        <div>
                            <h1 style="margin-bottom: 1rem; background: linear-gradient(135deg, #FDECEF, #745C97); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Silence Proxy</h1>
                            <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>
                            <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #745C97; color: white; border: none; border-radius: 8px; cursor: pointer;">–û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    `;
                }
            }
        });

        // –°–∫—Ä—ã–≤–∞–µ–º fallback —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const fallback = document.getElementById('fallback-message');
                if (fallback) {
                    fallback.style.display = 'none';
                }
            }, 500);
        });

        // Fallback –¥–ª—è Font Awesome –µ—Å–ª–∏ CDN –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
        setTimeout(() => {
            if (!window.FontAwesome || !document.querySelector('.fa')) {
                console.log('Font Awesome not loaded, applying fallback styles');
                const style = document.createElement('style');
                style.textContent = `
                    .fa, .fas, .far, .fal, .fad, .fab {
                        font-family: 'Segoe UI', system-ui, sans-serif !important;
                    }
                    .fa-user:before { content: "üë§"; }
                    .fa-bars:before { content: "‚ò∞"; }
                    .fa-download:before { content: "üì•"; }
                    .fa-headset:before { content: "üí¨"; }
                    .fa-mobile-alt:before { content: "üì±"; }
                    .fa-arrow-left:before { content: "‚Üê"; }
                    .fa-lock:before { content: "üîí"; }
                    .fa-key:before { content: "üîë"; }
                    .fa-play-circle:before { content: "‚ñ∂Ô∏è"; }
                    .fa-apple:before { content: "üçé"; }
                    .fa-google-play:before { content: "ü§ñ"; }
                    .fa-cc-visa:before { content: "üí≥"; }
                    .fa-telegram:before { content: "üì®"; }
                    .fa-times:before { content: "‚úï"; }
                `;
                document.head.appendChild(style);
            }
        }, 3000);
    </script>
</body>
</html>